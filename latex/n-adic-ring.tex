\section{$N$-adic Integers}
\par The goal of this section is to introduce the reader to the $N$-adic
integer ring and define the {\em N-adic valuation}. The 2-adic valuation
will be used to analyze bent sequences.

\subsection{$N$-adic Integer Ring}
\par The notation used in the definition of the $N$-adic numbers will follow
the same notation used by Borevich and Shafarevich in Chapter 1 of
{\em Number Theory} \cite{bk:bs66}. In this section, the set of $N$-adic
integers is shown to be a commutative ring with an identity.
  
\begin{definition}
\label{def:N-adic}
  Let $N$ be an integer. Then the infinite integer sequence $\xn$
  determines an {\em $N$-adic integer} $\alpha$, or
  $\xn \rightarrow \alpha$, if
  \begin{equation} \label{eq:seq}
  x_{i+1} \equiv x_i\pmod{N^{i+1}} \ \ \ \forall i \geq 0.
  \end{equation}
  Two sequences $\xn$ and $(x_n')$ determine the same $N$-adic integer if 
\begin{equation} \label{eq:equiv}
  x_i \equiv x_i' \pmod{N^{i+1}}\ \ \ \forall i \geq 0.
\end{equation}
  The {\em set of all $N$-adic integers} will be denoted by $\zzzn$.
\end{definition}

\par Each integer $x$ is associated with a $N$-adic integer, determined
by the sequence ($x,\ x, \ \dots, \ x,\ \dots$). These integers will be
called {\em rational integers} in the $N$-adic integers.
	
\begin{example} \label{ex:equiv-seq}
  Let $\xn \rightarrow \alpha \in \zzz_3$. Then the first 5 terms of
  $\xn$ may look something like:
  \begin{align*}
    \xn = (&\ 1\ , \ 1+2\cdot3 \ , \ 1+2\cdot3+1\cdot3^2 \ ,\\
            &1+2\cdot3+1\cdot3^2 \ , \ 1+2\cdot3+1\cdot3^2+1\cdot3^4 \ ,
              \ \dots)\\
        = (&1,7,16,16,97,\dots)
  \end{align*}
  Then equivalent sequences to $\xn$ could begin differently for the first
  few terms:
  \begin{align*}
    \yn &= (4,25,16,178,583,\dots) \\
    \zn &= (-2,-47,232,-308,97,\dots)
  \end{align*}
  The sequences for $\yn$ and $\zn$ satisfy equation (\ref{eq:seq}) for the
  first 5 terms, so they could be $N$-adic integers up to this point. Also,
  both are equivalent to $\xn$ according to the equivalence defined in
  equation (\ref{eq:equiv}).
  \begin{align*}
    &1 \equiv 4 \equiv 2 \pmod 3 \\
    &7 \equiv 25 \equiv -47 \pmod{3^2} \\
    &16 \equiv 16 \equiv 232 \pmod{3^3} \\
    &16 \equiv 178 \equiv -308 \pmod{3^4} \\
    &97 \equiv 583 \equiv 97 \pmod{3^5}
  \end{align*}
  Therefore $\xn,\yn,\zn \rightarrow \alpha$.
\end{example}

\par Because there are infinitely many sequence representations for any
$N$-adic integer, it is useful to define a canonical sequence to be used
when writing $N$-adic integers as sequences.
  
\begin{definition}
\label{def:canon}
  \par For a given $N$-adic integer $\alpha$, a given sequence $\an$ with
  the properties:
  \begin{enumerate}[i.]
    \item $\an \rightarrow \alpha$
    \item $\an=(a_0, \ a_0+a_1\cdot N, \ \dots, \ a_0+\dots+a_i\cdot N^i, \ \dots) : 0 \leq a_i < N \ \ \ \forall i \geq 0$
  \end{enumerate}
  will be called {\em canonical}.
	\par The sequence $(a_0,a_1,a_2,\cdots,a_i,\cdots)$ is the {\em digit
	representation} of $\alpha$. When $N<10$, the digits are usually
	written adjacent to one another. Another equivalent representation of $\alpha$
  is the {\it power series representation} where $\alpha=\sum_{i=0}^\infty
	a_iN^i$ where the $a_i$'s are from the digit representation of $\alpha$.
\end{definition}

\begin{example} \label{ex:canon}
  In Example \ref{ex:equiv-seq}, the sequence $\xn$ was a canonical
  sequence that determined the $N$-adic integer $\alpha$. A few more examples
  of canonical sequences determining 7-adic integers are given here:\\
  \\
 $\beta = 3164\dots = 3+1\cdot7+6\cdot7^2+4\cdot7^3+\cdots$, then the canonical sequence $(b_n) \rightarrow \beta$ is
  \begin{align*}
    (b_n) &= (3, \ 3+1\cdot7, \ 3+1\cdot7+6\cdot7^2, \ 3+1\cdot7+6\cdot7^2+4\cdot7^3, \ \dots)\\
            &= (3,10,304,1676,\dots)
  \end{align*}
  $\gamma = 0164\dots = 0+1\cdot7+6\cdot7^2+4\cdot7^3+\cdots$, then the canonical sequence $(c_n) \rightarrow \gamma$ is
  \begin{align*}
    (c_n) &= (0, \ 1\cdot7, \ 1\cdot7+6\cdot7^2, \ 1\cdot7+6\cdot7^2+4\cdot7^3, \ \dots)\\
            &= (0,7,301,1673,\dots)
  \end{align*}
  $\delta = 5031\dots = 5+0\cdot7+3\cdot7^2+1\cdot7^3+\cdots$, then the canonical sequence $(d_n) \rightarrow \delta$ is
  \begin{align*}
    (d_n) &= (5, \ 5, 5+3\cdot7^2, \ 5+3\cdot7^2+1\cdot7^3, \ \dots)\\
            &= (5,5,152,495,\dots).
  \end{align*}
\end{example}

\begin{definition}
  Addition and multiplication in $\zzzn$ are done term by term. \\
  Let $\alpha,\beta \in \zzzn$ and $\xn \rightarrow \alpha, \yn \rightarrow \beta$. Then,
  \begin{align*}
    \xn+\yn     &:= (x_0+y_0, x_1+y_1, \dots) \rightarrow \alpha+\beta\\
    \xn\cdot\yn &:= (x_0 \cdot y_0, x_1 \cdot y_1, \dots) \rightarrow \alpha \cdot \beta\\ 
  \end{align*}

  Define $(0,0,0,\dots) \rightarrow 0 \in \zzzn$ and $(1,1,1,\dots) \rightarrow 1 \in \zzzn$
\end{definition}

\begin{lemma}\label{lem:identity}
  For $\alpha \in \zzzn$, $\alpha+0=0+\alpha=\alpha$ and $1\cdot\alpha=\alpha\cdot1=\alpha$.
\end{lemma}
\begin{proof}
  Let $\xn\rightarrow\alpha\in\zzzn$.
  \begin{align*}
    \xn+(0,0,\dots)&=(x_0+0,x_1+0,\dots,x_i+0,\dots)\\
                     &=(x_0,\dots,x_i,\dots).\\
    (0,0,\dots)+\xn&=(0+x_0,0+x_1,\dots,0+x_i,\dots)\\
                     &=(x_0,\dots,x_i,\dots).
  \end{align*}
  $\xn=\xn+(0,0,\dots)=(0,0,\dots)+\xn$ implies $\alpha=\alpha+0=0+\alpha$.
  Therefore, the additive identity in $\zzzn$ is 0.

  \begin{align*}
    \xn\cdot(1,1,\dots)&=(x_0\cdot 1,x_1\cdot 1,\dots,x_i\cdot 1,\dots)\\
                         &=(x_0,\dots,x_i,\dots).\\
    (1,1,\dots)\cdot\xn&=(1\cdot x_0,1\cdot x_1,\dots,1\cdot x_i,\dots)\\
                         &=(x_0,\dots,x_i,\dots).
  \end{align*}
   $\xn=\xn\cdot(1,1,\dots)=(1,1,\dots)\cdot\xn$ implies $\alpha=\alpha\cdot1=1\cdot\alpha$.
  Therefore, the multiplicative identity in $\zzzn$ is 1.
\end{proof}   
% Insert examples of multiplication and addition

\par Finally, this section defines a {\em ring} and proves that $\zzzn$ is a
{\em commutative ring with an identity}.
\begin{definition}
\label{def:ring}
  A {\em ring} is a set $R$ with two binary operations defined on it. These are usually
  called addition denoted by +, and multiplication denoted by $\cdot$ or juxtaposition,
  satisfying the following six axioms:
  \begin{enumerate}
    \item Addition is commutative: $a+b=b+a \ \ \forall a,b \in R$.
    \item Addition is associative: $a+(b+c)=(a+b)+c \ \ \forall a,b,c \in R$.
    \item There exists an additive identity, denoted by 0, such that $a+0=a \ \ \forall a \in R$.
    \item $\forall a \in R$ there exists an additive inverse, denoted by $-a$, such
      that $a+(-a)=0$.
    \item Multiplication is associative: $a(bc)=(ab)c \ \forall a,b,c \in R$
    \item Multiplication is left and right distributive over addition:
      \begin{align*}
        a(b+c)&=ab+ac \\
        (b+c)a&=ba+ca
      \end{align*}
  \end{enumerate}
  If it is also true that
  \begin{enumerate}
      \setcounter{enumi}{6}
    \item Multiplication is commutative: $ab=ba \ \ \forall a,b \in R$, then
      $R$ is a {\em commutative ring}.
  \end{enumerate}
  Further if
  \begin{enumerate}
      \setcounter{enumi}{7}
    \item There exists a multiplicative identity denoted by 1 such that
      $a \cdot 1=a$ and $1 \cdot a=a \ \ \forall a \in R$, then $R$ is a
      {\em ring with an identity}.
  \end{enumerate}
  If $R$ satisfies all eight properties, then $R$ is a {\em commutative ring with
  an identity.}
\end{definition}

\begin{theorem}
  $\zzzn$ is a commutative ring with an identity.
\end{theorem}
% p-adic integer ring proof
\begin{proof}
  Let $\xn,\yn,\zn$ determine $\alpha,\beta,\gamma\in\zzzn$ respectively. Then
  \begin{enumerate}
    \item {\em Commutativity of Addition}
      \begin{align*}
            \xn+\yn&=(x_0+y_0,\dots,x_i+y_i,\dots) \\
                   &=(y_0+x_0,\dots,y_i+x_i,\dots) \\
                   &=\yn+\xn.
      \end{align*}
      $\xn+\yn \rightarrow \alpha+\beta$ and $\xn+\yn=\yn+\xn \rightarrow \beta+\alpha$.
      Therefore, by Definition \ref{def:N-adic}, $\alpha+\beta=\beta+\alpha$.
    \item {\em Associativity of Addition}
      \begin{align*}
        \xn+(\yn+\zn)&=\xn+(y_0+z_0,\dots,y_i+z_i,\dots) \\
                     &=(x_0+(y_0+z_0),\dots,x_i+(y_i+z_i),\dots) \\
                     &=((x_0+y_0)+z_0,\dots,(x_i+y_i)+z_i,\dots) \\
                     &=(x_0+y_0,\dots,x_i+y_i,\dots)+\zn \\
                     &=(\xn+\yn)+\zn.
      \end{align*}
      Therefore, $\alpha+(\beta+\gamma)=(\alpha+\beta)+\gamma$.
    \item {\em Existence of the Additive Identity}
      \\ \\
      By Lemma \ref{lem:identity}, $0$ is the additive identity.
    \item {\em Existence of Additive Inverses}
      \\ \\
      Define $-\xn = (N-x_0,N^2-x_1,\dots,N^{i+1}-x_i,\dots) \rightarrow -\alpha$.
      Then
      \begin{align*}
        \xn+(-\xn)&=(x_0+N-x_0,x_1+N^2-x_1,\dots,x_i+N^{i+1}-x_i,\dots) \\
                  &=(N,N^2,\dots,N^{i+1},\dots) \\
                  &\equiv(0,0,\dots) \\
                  &=0.
      \end{align*}
      Therefore, $\alpha+(-\alpha)=0$.
    \item {\em Associativity of Multiplication}
      \begin{align*}
        \xn(\yn\zn)&=\xn(y_0z_0,\dots,y_iz_i,\dots) \\
                   &=(x_0(y_0z_0),\dots,x_i(y_iz_i),\dots) \\
                   &=((x_0y_0)z_0,\dots,(x_iy_i)z_i,\dots) \\
                   &=(x_0y_0,\dots,x_iy_i,\dots)\zn \\
                   &=(\xn\yn)\zn.
      \end{align*}
      Therefore, $\alpha(\beta\gamma)=(\alpha\beta)\gamma$.
    \setcounter{enumi}{6}
    \item {\em Commutativity of Multiplication}
      \begin{align*}
        \xn\yn&=(x_0y_0,\dots,x_iy_i,\dots) \\
              &=(y_0x_0,\dots,y_ix_i,\dots) \\
              &=\yn\xn.
      \end{align*}
      Therefore, $\alpha\beta=\beta\alpha$.
    \setcounter{enumi}{5}
    \item {\em Left and right distributivity of multiplication over addition}
      \begin{align*}
        \xn(\yn+\zn)&=\xn(y_0+z_0,\dots,y_i+z_i,\dots) \\
                    &=(x_0(y_0+z_0),\dots,x_i(y_i+z_i),\dots) \\
                    &=(x_0y_0+x_0z_0,\dots,x_iy_i+x_iz_i,\dots) \\
                    &=\xn\yn+\xn\zn. \\
      \end{align*}
      By commutativity of multiplication,
      \begin{align*}
        (\yn+\zn)\xn&=\xn(\yn+\zn)\\
                    &=\xn\yn+\xn\zn\\
                    &=\yn\xn+\zn\xn.
      \end{align*}
      Therefore, $\alpha(\beta+\gamma)=\alpha\beta+\alpha\gamma$ and
      $(\beta+\gamma)\alpha=\beta\alpha+\gamma\alpha$.
    \setcounter{enumi}{7}
    \item {\em Existence of a multiplicative identity}
      \\ \\
      By Lemma \ref{lem:identity}, 1 is the multiplicative identity.
      \\ \\
      Properties 1 through 8 from Definition~\ref{def:ring} are satisfied,
      so $\zzzn$ is a commutative ring with an identity.
  \end{enumerate}
\end{proof}

\par So that the power series representations of N-adic numbers make sense in
the discussion of FCSRs in Section \ref{sec:shift-registers}, equivalence is
shown between the defined $N$-adic addition and multiplication and the usual
addition and multiplication of power series representations of $N$-adic
integers.

\begin{lemma}
	Addition and multiplication of canonical sequences of $\alpha$ and $\beta$ are
	equivalent to the usual addition and multiplication of the power series
	representations for $\alpha$ and $\beta$.
\end{lemma}
\begin{proof}
	Let $\alpha=(a_0,a_0+a_1N,\cdots,a_0+a_1N+\cdots+a_kN^k,\cdots)$
	and $\beta=(b_0,b_0+b_1N,\cdots,b_0+b_1N+\cdots+b_kN^k,\cdots)$. And $\alpha'$
	and $\beta'$ be represented by power series so that
	\[
		\alpha'=\sum_{i=0}^\infty a_iN^i{\rm \ and\ } \beta'=\sum_{i=0}^\infty b_iN^i.
	\]
	Rewrite $\alpha=(\sum_{i=0}^ia_i,\cdots,\sum_{i=0}^ka_i2^i,\cdots)$ and
	$\beta=(\sum_{i=0}^ib_i,\cdots,\sum_{i=0}^kb_i2^i,\cdots)$. By the defined
	$N$-adic addition,
	\begin{align*}
		\alpha+\beta&=(\sum_{i=0}^0a_i+b_i,\cdots,\sum_{i=0}^k(a_i+b_i)2^i,\cdots)\\
		            &=\sum_{i=0}^\infty(a_i+b_i)2^i\\
								&=\sum_{i=0}^\infty a_iN^i + \sum_{i=0}^\infty b_iN^i\\
								&=\alpha'+\beta'.
  \end{align*}
	Clearly addition is equivalent. By the defined $N$-adic multiplication,
	\begin{align*}
		\alpha\cdot\beta&=(\sum_{i=0}^0a_i\cdot b_i,\cdots,\sum_{i=0}^k\sum_{j=0}^k(a_ib_j)2^{i+j},\cdots)\\
		                &=(a_0\cdot b_0,\cdots,\sum_{i+j\leq k}(a_ib_j)2^{i+j},\cdots)\\
										&=\sum_{k=0}^\infty\left(\sum_{i+j=k}a_ib_j2^k\right)\\
										&=\left(\sum_{i=0}^\infty a_i2^i\right)\left(\sum_{j=0}^\infty b_j2^j\right)\\
										&=\alpha'\cdot\beta'.
	\end{align*}
	Therfore, multiplication is equivalent as well.
\end{proof}

\begin{theorem}\label{thm:units}
  An $N$-adic integer $\alpha$, which is determined by a sequence $\xn$, is
  a unit if and only if $x_0$ is relatively prime to $N$.
\end{theorem}
\begin{proof}
  Let $\alpha$ be a unit. Then there is an $N$-adic integer $\beta$ such
  that $\alpha\beta=1$. If $\beta$ is determined by the sequence $\yn$, then
  \begin{equation}\label{eq:units}
    x_iy_i\equiv1\pmod{N^{i+1}} \ \ \forall i \geq 0.
  \end{equation}
  In particular, $x_0y_0\equiv1\pmod N$, hence $x_0$ is relatively prime to
  $N$. 
  \par Conversely, let $x_0$ be relatively prime to $N$. Then
  $x_0\not\equiv0\pmod{N}$. From Equation (\ref{eq:seq})
  \begin{align*}
    x_1 &\equiv x_0 \pmod N\\
    &\vdots \\
    x_{i+1} &\equiv x_i \pmod{N^i}. 
  \end{align*}
  Working backward, $x_{i+1} \equiv x_i \equiv \dots \equiv x_1 \equiv
  x_0 \pmod N$. Thus, $x_i$ is relatively prime to $N \ \forall i\geq0$,
  which implies $x_i$ is relatively prime to $N^{i+1}$. Consequently,
  $\forall i\geq0 \ \exists y_i$ such that $x_iy_i \equiv 1 \pmod{N^{i+1}}$.
  Since $x_{i+1} \equiv x_i \pmod N^i$ and $x_{i+1}y_{i+1} \equiv
  x_iy_i \pmod{N^i}$. Then, $y_{i+1} \equiv y_i \pmod{N^i}$. Therefore the
  sequence $\yn$ determines some $N$-adic integer $\beta$. Because
  $x_iy_i \equiv 1 \pmod{N^{i+1}} \ \ \forall i \geq 0$, $\alpha\beta=1$.
  This means $\alpha$ is a unit.
\end{proof}

\par From this theorem it follows that a rational integer $a\in\zzzn$ is a
unit if and only if $a$ is relatively prime to $N$. If $a$ is invertible in
$\zzzn$, then for any rational integer $b\in\zzzn$, $b/a=a^{-1}b\in\zzzn$.

\par For any rational number $b/a$, $a$ relatively prime to $N$, there
exists a sequence $\xn \rightarrow b/a \in \zzzn$. At this point, it is
worth using the digit representation for integers in $\zzzn$. So
$\xn=\{x_0, \ x_0+x_1N, \ \dots, \ x_0+\dots+x_iN^i, \ \dots\}$ and
$b/a = x_0x_1\dots x_i\dots$. Rather than finding $a^{-1}\pmod{N^{i+1}}$ to
determine each $x_i$, it is not too difficult for every $i$ to find
$\sum_{k=0}^ix_kN^k$ such that
\begin{equation}\label{eq:seq-rational}
  b \equiv a\sum_{k=0}^ix_kN^k \pmod{N^{i+1}}.
\end{equation}
Then, 
\begin{equation}
  x_i = \frac{\sum_{k=0}^ix_kN^k - \sum_{k=0}^{i-1}x_kN^k}{N^i}.
\end{equation}

\par Nearly all of the digits for any rational number in $\zzzn$ can also be
found using powers of $N^{-1}$, which is much simpler to analyze than the
brute force search for the digits mentioned above. The following theorem is a
slightly modified version of Theorem 10 in a draft of \cite{bk:gk12} written
by Andrew Klapper and Mark Goresky.

\begin{theorem}\label{thm:10}
  Let $u_0,q,N\in\zzz$, where $q$ is relatively prime to $N$,
  $\lvert u_0 \rvert < q$, and $q=-q_0+\sum_{i=1}^{r}q_iN^i$ for
  $0 \leq q_i < N$. Define $\alpha = u_0/q \in \zzzn$
  such that $\alpha = \sum_{i=0}^{\infty}a_iN^i$ for $0 \leq a_i < N$.
  Also, define $u_k\in\zzz$ such that $u_k/q =
  \sum_{i=k}^{\infty}a_iN^{i-k} \in \zzzn$ and
  $\gamma \equiv N^{-1} \pmod q$. Then, there exist $u_k$ for every $k\geq0$
  such that
  \begin{equation}\label{eq:ak}
    a_k \equiv q^{-1}u_k \pmod N.
  \end{equation}
  If $-q<u_0<0$, then $u_k \in \{-q,\dots,-1\}$ for $k\geq0$.  Otherwise,
  for $k>\lfloor \log_N(q) \rfloor=r$, $u_k \in \{-q,\dots,-1\}$.
  \\ \\
  Let $\omega \in \{-q,\dots,-1\}$ such that $\omega \equiv
  \gamma^k u_0 \pmod q$.  Then for $k>\lfloor \log_N(q) \rfloor=r$, or if
  $-q<u_0<0$, then $k\geq0$,
  \begin{equation}\label{eq:ak-omega}
    a_k \equiv q^{-1}\omega \pmod N.
  \end{equation}
\end{theorem}
\noindent \\ 
\begin{proof}
  Write $u_0/q$ in terms of $u_k$.
  \begin{align}
    \frac{u_0}{q} &= a_0 + N\frac{u_1}{q}
                     = a_0 + a_1N + N^2\frac{u_2}{q}
                     = \dots \nonumber \\
                  &= \sum_{i=0}^{k-1}a_iN^i + N^k\frac{u_k}{q} \ \ 
                    \forall k \geq 1. \label{eq:u0/q}
  \end{align}
  Rewrite (\ref{eq:u0/q}) to be
  \begin{equation}\label{eq:u0/q-rw}
    N^ku_k=u_0-q\left(\sum_{i=0}^{k-1}a_iN^i\right) \ \ \forall k \geq 1
  \end{equation}
  Then $\lvert u_0 \rvert < q$ and $0 \leq a_i < p$ from the assumptions and
  equation (\ref{eq:u0/q-rw}). These imply for all $k \geq 1$,
  $\lvert u_0 \rvert = \lvert q\sum_{i=0}^{k-1}a_iN^i + N^ku_k \rvert < q$.
  Then,
  \begin{equation*}
%    -q-q\sum_{i=0}^{k-1}a_iN^i < N^k&u_k < q-q\sum_{i=0}^{k-1}a_iN^i \\
    -q\left(\frac{1+\sum_{i=0}^{k-1}a_iN^i}{N^k}\right)
      < \ u_k
      < q\left(\frac{1-\sum_{i=0}^{k-1}a_iN^i}{N^k}\right).
  \end{equation*}
  $u_k$ may only be greater than zero when $\frac{1-\sum_{i=0}^{k-1}a_iN^i}
  {N^k}$ is greater than zero. This only occurs when the sequence
  $(a_0,\dots,a_j) = (0,\dots,0)$ for $j\geq0$. Such a sequence occurs if
  and only if $u_0\geq0$ and $u_0 \equiv 0 \pmod{N^i}$ for $0\leq i \leq j$,
  $j\geq0$. This is clear from the construction of $N$-adic sequences for
  rational numbers. Therefore $u_k$ may only be greater than zero if
  $u_0\geq0$ and $u_0 \equiv 0 \pmod{N^i}$ for $0\leq i \leq j$, $j\geq0$.
  The lower bound for $u_k$ is greater than $-q$. This is clear because
  $\frac{1+\sum_{i=0}^{k-1}a_iN^i}{N^k}\leq1$.
  Therefore,
  \begin{equation*}
    -q < u_k < 0 {\rm \ \ for \ } -q<u_0<0.
  \end{equation*}
  If $0\leq u_0<q$, then the upper bound remains unchanged.
  \begin{equation*}
    -q < u_k < q\left(\frac{1-\sum_{i=0}^{k-1}a_iN^i}{N^k}\right)
      \ {\rm for} \ 0\leq u_0 < q
  \end{equation*}
  There is still work to be done on the upper bound.
  \begin{align*}
                &0 \leq \sum_{i=0}^{k-1}a_iN^i < N^k \ for \ k\geq1 \\
    \Rightarrow &-q\left(\sum_{i=0}^{k-1}a_iN^i\right) \leq 0 \\
    \Rightarrow \ &u_0-q\left(\sum_{i=0}^{k-1}a_iN^i\right)<q \\
    \Rightarrow \ &N^ku_k<q \\
    \Rightarrow \ &u_k<\frac{q}{N^k}.
  \end{align*}
  For $k>\lfloor\log_N(q)\rfloor=r$, $\lvert q/N^k \rvert < 1$. Therefore,
  $-q < u_k < 0 \ {\rm for} \ 0\leq u_0 < q \ {\rm and} \ k>r$.
  Further lowering the upperbound, if $u_k=0$, then
  $u_0/q=\sum_{i=0}^{k-1}a_iN^i+0$. This implies $u_0/q$ is a rational
  integer, which is not true. Noting finally that $u_k$ must be an integer.
  If $\lvert u_0 \rvert<q$ and $u_0<0$, or $\lvert u_0 \rvert<q$,
  $u_0\geq0$, and $k>\lfloor \log_N(q) \rfloor=r$, then
  \begin{equation*}
    u_k \in \{-q,\dots,-1\}.
  \end{equation*}
  It has now been shown, for certain restrictions, $u_k$ belongs to a
  specific set of representatives for the residue classes of $\zzz/(q)$.
  Define $\gamma \equiv N^{-1} \pmod q$. Reducing Equation
  (\ref{eq:u0/q-rw}) modulo $q$ shows that
  \begin{equation}
    u_k \equiv \gamma u_{k-1} \pmod q.
  \end{equation}
  Since this is true for all k greater than or equal to 1, it is clear that
  \begin{equation}\label{eq:uk-mod-q}
    u_k \equiv \gamma^ku_0 \pmod q.
  \end{equation}
  Reducing (\ref{eq:u0/q-rw}) modulo $p$ shows that
  \begin{equation}\label{eq:ak-mod-p}
    a_k \equiv q^{-1}u_k \pmod N.
  \end{equation}
  Define $\omega \equiv \gamma^k u_0 \pmod q$, and
  $\rho \equiv q^{-1} \pmod N$.  Finally, if $\lvert u_0 \rvert<q$ and
  $u_0<0$, or $\lvert u_0 \rvert<q$, $u_0\geq0$, and
  $k>\lfloor \log_N(q) \rfloor=r$, then
  \begin{equation}\label{eq:ak-done}
    a_k \equiv \rho\omega \pmod N.
  \end{equation}
\end{proof}
\begin{corollary}\label{cor:aj}
  Let $0\leq u_0 < q$. Define $j$ to be the greatest integer such that
  $u_0 \equiv 0 \pmod{N^j}$. Then the following are true:
  \begin{enumerate}[i.]
%    \item $j\leq\lfloor\log_p{q}\rfloor = r$
    \item $(a_0,\dots,a_{j-1})=(0,\dots,0)$
    \item $u_k>0$ for $k=j$
    \item $u_k \not\equiv 0 \pmod N$
  \end{enumerate}
\end{corollary}

% examples demonstrating the corollary

\par Theorem \ref{thm:10} shows that for $-q<u_0<0$, there is a sequence of
numerators $\{u_k\}$ directly related to the sequence of digits $\{a_k\}$
for $u_0/q\in\zzzn$. The sequence of numerators for a given FCSR with connection
integer $q$ reveals all of the possible strictly periodic states of the
register, each identified by $u_k/q$. This provides an interesting tool for the
analysis of different FCSRs.

% add sage code demonstrating this in the 2-adic case.

\subsection{2-adic Integers}
\par Now, the transition is made to discussing the 2-adic integers whose digit
sequences are infinite sequences of 0s and 1s. The following definitions and
propositions will be used in the discussion of FCSRs and the main result.

\begin{proposition}{\rm \cite{art:kg97}}\label{prop:rational-periodic}
	There is a one-to-one correspondence between rational numbers
	$\alpha=p/q\in\zzz_2$ (where $q$ is odd) and eventually periodic binary
	sequences ${\bf a}=(a_0,a_1,\cdots)$, which associates to each such rational
	number $\alpha$ its digit representation {\bf a}. The sequence ${\bf a}$ is
	strictly periodic if and only if $\alpha\leq 0$ and $|\alpha|<1$.
\end{proposition}
\begin{proof}
	\par Consider the strictly periodic case first. Let ${\bf a}=(a_0,a_1,\cdots)$
	be a strictly periodic sequence of period $T$. Set $\alpha={\bf a}$. Computing
	in $\zzz_2$,
	\[
		2^T\alpha=\sum_{i=0}^\infty a_i2^{i+T}
		         =\sum_{i=0}^\infty a_{i+T}2^{i+T}
						 =\sum_{i=T}^\infty a_i2^i
						 =\alpha-\sum_{i=0}^{T-1}a_i2^i.
	\]
	Hence
	\begin{equation}\label{eqn:3}
		\alpha=-\frac{\sum_{i=0}^{T-1}a_i2^i}{2^T-1}
	\end{equation}
	is a negative rational number. Write $\alpha=p/q$ as a fraction reduced to
	lowest terms with $q$ positive. Then $q$ is odd, $p\leq0$, and $|p|<q$.
	\par On the other hand, suppose that $\alpha=p/q$ is given in lowest terms
	with $q$ an odd positive integer, $p\leq0$, and $|p|<q$. Let $T$ be the
	smallest integer such that $2^T\equiv 1 \pmod q$. Such a $T$ exists because
	$q$ is odd. Then $2^T-1$ is divisble by $q$, so set $s=(2^T-1)/q$. Because
	$p=q\sum_{i=0}^\infty a_i2^i$
	\[
		s\cdot(-p)=s(-q\sum_{i=0}^\infty a_i2^i)
		          =(1-2^T)(\sum_{i=0}^\infty a_i2^i)
		          =\sum_{i=0}^\infty a_i2^i - \sum_{i=T}^\infty a_i2^i
							=\sum_{i=0}^{T-1}a_i2^i
	\]
	Thus $\alpha=sp/(2^T-1)=-(\sum_{i=0}^{T-1}a_i2^i)/(2^T-1)$. It directly
	follows that $\alpha=2^T\alpha+\sum_{i=0}^{T-1}a_i2^i$, implying that the
	digits sequence ${\bf a}$ of $\alpha$ is strictly periodic.
	\par Now suppose that $\alpha=p/q$ is an arbitrary rational number. Let
	$M=\lceil\alpha\rceil$ be the next largest integer. If $M\geq0$, then its digit
	sequence ends in an infinite string of 0s. If $M<0$, then its digit sequence
	ends in an infinite string of 1s. However, $\alpha=M+p'/q$ where $p'\leq0$ and
	$|p'|<q$, so the digit sequence of $p'/q$ is strictly periodic. It follows
	that the digit sequence ${\bf a}$ of $\alpha=M+p'/q$ must be eventually
	periodic.
	\par On the other hand, an eventually periodic sequence ${\bf
	a}=(a_0,a_1,\cdots)$ corresponds to a rational number $\alpha={\bf a}$ because
	it is given by a finite transient term $\sum_{i=0}^{K-1}a_i2^i$ (for some
	nonnegative integer $K$) plus a periodic term, $\sum_{i=K}^\infty
	a_i2^i=2^K\sum_{i=0}^\infty a_{j+K}2^j$, both of which are rational numbers.
\end{proof}



\par The 2-adic valuation is needed for the main result. It is defined here.

\begin{definition}\label{2-adic-val}
  Let $\alpha=\an\in\zzz_2\setminus(0)$. If $m$ is the smallest number in
  $\nnn$ such that $a_m \not\equiv 0 \pmod{2^{m+1}}$, then the {\em 2-adic\ 
  valuation} of $\alpha$ is $m$, or $\log_2(\alpha)=m$. If $\alpha=0$, then
  $\log_2(\alpha)=\infty$.
\end{definition}

\begin{definition}\label{2-adic-norm}
	If $\alpha \in \zzz_2$, then the {\em 2-adic norm} of $\alpha$ is
  $\lVert \alpha \rVert_2 = 2^{-m}$ where $m=\log_2(\alpha)$. 
\end{definition}

\par This paper will be careful not to confuse $\log_2$ in $\zzzn$ with 
$\log_2$ in $\mathbb{R}$.

\begin{example}
  Let $\alpha=00001011011\cdots\in\zzz_2$. Then $\log_2(\alpha)=4$.
\end{example}

